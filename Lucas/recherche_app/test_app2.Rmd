---
title: "Untitled"
author: "Chaveneau Lucas"
date: "05/03/2022"
output: html_document
---

```{r}
library(reticulate)
library(tidyverse)
library(tidyr)
library(DT)
```

```{r}
py_install('bs4')
py_install('requests')
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Python

```{r}
Sys.which("python")
```


```{r}
np <- import('bs4', as = 'bs')
```



########################## Table databale ############################



```{r}
data <- readRDS('data_jeux.rds')
```


```{r}
data[1:3,1:3] %>% datatable(rownames = T,
                            extensions = c('Select'),
                            selection = "first",
                            options = list(
                              select = list(style = 'os', items = 'row'), 
                              dom = 't',
                              ordering = F)) 
```


```{r}
 paste0('<img alt="Air Hockey Android Front Cover" border="0" src="https://www.mobygames.com/images/covers/s/264995-air-hockey-android-front-cover.jpg" height="120" width="120">')
```




```{r}
data[1,1:3] %>%
  mutate(image =  paste0("<img src=\"", src="https://www.mobygames.com/images/covers/s/264995-air-hockey-android-front-cover.jpg", "\" height=\"80\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"", "bijo", "\"></img>")) %>% 
  datatable(escape = F)
```
 src="/images/covers/l/264995-air-hockey-android-front-cover.png"
 
 Il risque peut etre d'avoir des problème pour la selection lorsq'uon passera sur server. Peut etre utilisé `reactable`
 
```{r}
data[1:3,1:3] %>% datatable(rownames = T,
                            extensions = c('Select'),
                            selection = "first",
                            options = list(
                              select = list(style = 'os', items = 'row'), 
                              dom = 't',
                              ordering = F)) 
```
 
```{r}
data[2,]
```
 
```{r}
data[,1:3] %>% slice(1:3) %>%
        select(everything()) %>% 
        datatable(rownames = F,
                  extensions = c('Select'),
                  selection = "single",
                  options = list(
                    select = list(style = 'os', items = 'row'), 
                    dom = 't',
                    ordering = F),
                  escape = F) 
```
 
```{r}
Annee <- as.factor(Annee)
```

```{r}
levels(Annee)
```

```{r}
platform <- as.factor(platform)
levels(platform)
```
 
 
```{r}
c(colnames(data))
```
 
```{r}
data %>%arrange(desc(reviews)) %>% slice(1:3) %>% select(Name, reviews)
```
 
```{r}
tablo <-data %>%
  filter(as.numeric(as.character(Annee)) >= 1980) %>%
  filter(as.numeric(as.character(Annee)) <= 1950)
```
 
```{r}
tablo <- data
tablo %>% 
    filter( ==1)
```

```{r}
variable_genre <- reactive({switch(
    genre1,
    "Action" = df2$Action,
    "Aventure" = df2$Aventure,
    "Puzzle" = df2$Puzzle,
    "Racing" = df2$Racing,
    "Education" = df2$Educational,
    "Compilation" = df2$Compilation,
    "Simulation" = df2$Simulation,
    "Sports" = df2$Sports,
    "Strategie" = df2$Strategie,
    "Role_play" = df2$Role_play,
    "Edition_special" = df2$Edition_special,
    "DLC" = df2$DLC)
  }) 
```

```{r}
genre1 = c('Action', 'Aventure')
```

```{r}
liste = NULL
for (element in genre1){
  liste = c(liste, element)
}
```


```{r}

switch_manuel <- function(x){switch(x, "2" = "2", "3" = "3")}
sapply(c("2","3"), switch_manuel)
```

```{r}
data %>% 
  mutate(choix = data %>% select(c(Action, Puzzle)) %>% rowSums()) %>% 
  filter(choix > 0)

data %>% 
  mutate(choix = rowSums(select(Troisieme_personne, Derriere)))

data %>% 
  filter(rowwise(c(Strategie, Sports)) > 0)

data %>% 
  filter(rowsum(Action, Puzzle) > 0)

data %>% 
  mutate(truc = rowwise(Action))
```

```{r}

```


```{r}
mutate(data, choix = select(data, ))
```

```{r}
select(Action)
```

```{r}
paste0('df')
```
```{r}
data %>% 
  rowwise() %>% 
  mutate(truc = sum(c(Action, Puzzle)))
```

```{r}
mutate(data, )
```

```{r}
data <- as_tibble(data)
```

```{r}
class(data)
```
```{r}
data[c('Action', 'Puzzle')]
```
```{r}
data[,c(Action, Puzzle)]
```

```{r}
tablo <- data[1:100000,]
```


```{r}
tablo %>% 
  filter(tablo[c('Action', 'Puzzle')] %>% rowSums() > 0)
```

```{r}
data %>% slice(numeric(1))
numeric(1)
```

```{r}
cat(Description[1])
```
```{r}
description <- data %>% slice(3) %>% pull(Description)
```

```{r}
paste0('<b>', description %>% str_replace("\n", "<br>"), '</b>')
description %>% str_replace("\n", "<br>")
```

```{r}
desc2 <- "Ndsqjdqso. jDIOQSJOSDQ.oids. "
str_to_title(desc2)
```

```{r}
str_to_sentence(desc2)
```

```{r}
desc <- "\nTwo titles are available in this cart:\narmored encounter! is a clone of atari's combat. two players control tanks and try to shoot each other the most in a time limit of three minutes. each tank has 20 rounds of ammunition. the last three rounds will change color, warning the player the ammunition is low. this game offers 12 variations, selected by the alphanumeric keys:\n(pressing a): plays over open country using cannon.\n(pressing b): plays over hilly terrain (simple bars) with cannon.\n(pressing c): plays over mountainous terrain (complex barriers) with cannon.\n(pressing d): open country with guided missiles.\n(pressing e): simple barriers with guided missiles.\n(pressing f): complex barriers with guided missiles.\n(pressing g): plays over open country with minefields (represented by x's on the screen - if a tank hits one of them, a point is scored to the adversary) and cannon.\n(pressing h): simple barriers with minefields and cannon.\n(pressing i): complex barriers with minefields and cannon.\n(pressing j): open country - minefields - guided missiles.\n(pressing k): simple barriers - minefields - guided missiles.\n(pressing l): complex barriers - minefields - guided missiles.\n\n\nsub chase! features a hawk hunter-killer jet against a shark missile-launching submarine. one player controls the jet, which scrolls left, and the other controls the submarine, which scrolls right. while neutral ships sail on the water surface, the players have to shoot each other the most in a time limit of three minutes. each hit on the enemy scores one point to the player and each hit on the neutral vessels subtracts one point. there are three game variations, selected by the numeric keys:(pressing 1): guided missiles with rear launch pattern.\n(pressing 2): unguided missiles with rear launch pattern.\n(pressing 3): guided missiles with forward launch pattern.\n[edit description]"

```


```{r}
desc %>% str_to_upper() %>% str_to_sentence()
```

## Creation des noms de publisher 

```{r}
Publisher <- as.factor(Publisher)
```

```{r}
truc = fct_count(Publisher, sort = T)[1:3500,1]
```

```{r}
truc
```

```{r}
data <- readRDS('data_jeux_image.rds')
```


```{r}
df <- read_csv('vgsales2.csv')
```

```{r}
data <- readRDS('data_jeux_image.rds')
```


```{r}
data[1,30] %>% 
  str_replace('src=\"/', "src=\"https://www.mobygames.com/")
```
```{r}
paste0("<img alt=\"007: James Bond - The Stealth Affair DOS Front Cover\" border=\"0\" height=\"150\" src=\"https://www.mobygames.com/images/covers/s/261101-007-james-bond-the-stealth-affair-dos-front-cover.jpg\" width=\"120\"/>")
```


```{r}
iscreen <- "<img alt=\"007 Car Chase Commodore 64 Title\" border=\"0\" height=\"112\" src=\"https://www.mobygames.com/images/shots/s/311197-007-car-chase-commodore-64-screenshot-title.jpg\" title=\"Missing cover image (using game screenshot)\" width=\"160\">"
```

```{r}
paste0("<img src=\"", src="https://www.mobygames.com/images/covers/s/264995-air-hockey-android-front-cover.jpg", "\" height=\"80\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"", "bijo", "\"></img>")
```


```{r}
iscreen <- "<img alt=\"007: James Bond - The Stealth Affair DOS Front Cover\" border=\"0\" height=\"150\" src=\"https://www.mobygames.com/images/covers/s/261101-007-james-bond-the-stealth-affair-dos-front-cover.jpg\" width=\"120\"/>"
```


```{r}


data %>% 
  slice(1:3) %>% 
  mutate(picture = c(iscreen, iscreen, iscreen)) %>% 
  select(picture, Name) %>% 
  datatable()
```

```{r}
"<img title="Missing cover image (using game screenshot)" alt="007 Car Chase Commodore 64 Title" border="0" src="/images/shots/s/311197-007-car-chase-commodore-64-screenshot-title.jpg" height="112" width="160">"
```



```{r}
data[1,1:3] %>%
  mutate(image =  paste0("<img alt=\"007 Ice Racer ExEn Game splashscreen\" border=\"0\" height=\"80\" src=\"https://www.mobygames.com/images/shots/s/149436-007-ice-racer-exen-screenshot-game-splashscreen.jpg\" title=\"Missing cover image (using game screenshot)\" width=\"104\"/>")) %>% 
  datatable(escape = F)
```


```{r}
data[1,30]
```

```{r}
data[1,30] %>% str_extract("width=\"\\d+\"") %>% str_extract("\\d+") %>% as.numeric()* 0.5
```
```{r}
fruit <- c("apple", "banana", "pear", "pinapple")
str_detect(fruit, "a")
str_detect(fruit, "^a")
str_detect(fruit, "a$")
str_detect(fruit, "b")
str_detect(fruit, "[aeiou]")
```

```{r}
"width=\"104\"" %>% str_extract("width=\"\\N\"") 
```


```{r}
fruits <- c("one apple", "two pears", "three bananas")
str_replace(fruits, "[aeiou]", "-")
str_replace_all(fruits, "[aeiou]", "-")
str_replace_all(fruits, "[aeiou]", toupper)
str_replace_all(fruits, "b", NA_character_)

str_replace(fruits, "([aeiou])", "")
str_replace(fruits, "([aeiou])", "\\1\\1")
str_replace(fruits, "[aeiou]", c("1", "2", "3"))
str_replace(fruits, c("a", "e", "i"), "-")
```

```{r}
"width=\"104\"" %>% str_extract("width=\"\\d+\"") %>% str_extract("\\d+")
```


```{r}
valeur = data[1,30] %>% str_extract("width=\"\\d+\"") %>% str_extract("\\d+") %>% as.numeric()# %>% as.character()

data[1,30] %>% str_replace(paste0("width=\"",valeur,"\""), paste0("width=\"",valeur * 0.5,"\"") )
```

```{r}
data %>% slice(1:3) %>% 
  mutate(valeur_width = image %>%  
           str_extract("width=\"\\d+\"") %>% 
           str_extract("\\d+") %>% 
           as.numeric(),
         valeur_height = image %>%  
           str_extract("height=\"\\d+\"") %>% 
           str_extract("\\d+") %>% 
           as.numeric()) %>% 
  mutate(image = image %>% 
           str_replace(paste0("width=\"",valeur_width,"\""), paste0("width=\"",valeur_width * 0.5,"\"")) %>% 
           str_replace(paste0("height=\"",valeur_height,"\""), paste0("height=\"",valeur_height * 0.5,"\""))) %>% 
  select(image)
```

```{r}
data2 <- read_csv('vgsales2.csv')
```

```{r}
data2[1,13] %>% str_replace_all("src=\"", "src=\"https:") %>% str_replace_all("srcset=\"", "srcset=\"https:") %>% str_replace_all("href=\"", "href=\"https://en.wikipedia.org") %>% str_replace("style=\"float: right;", "style=\"float: right; background-color: #F9ECDD;")
```
```{r}
paste(data[1,12])
```
```{r}
data %>% slice(1) %>% select(Description) %>% 
  str_remove_all("\\[.*?\\]")
```

"<script>document.documentElement.className=\\"client-js\";RLCONF={\"wgBreakFrames\":false,\"wgSeparatorTransformTable\":[\"\",\"\"],\"wgDigitTransformTable\":[\"\",\"\"],\"wgDefaultDateFormat\":\"dmy\",\"wgMonthNames\":[\"\",\"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\"July\",\"August\",\"September\",\"October\",\"November\",\"December\"],\"wgRequestId\":\"f6230c7f-90b8-44fd-9dda-236eb619d7e5\",\"wgCSPNonce\":false,\"wgCanonicalNamespace\":\"\",\"wgCanonicalSpecialPageName\":false,\"wgNamespaceNumber\":0,\"wgPageName\":\"Nintendo_Entertainment_Analysis_\u0026_Development\",\"wgTitle\":\"Nintendo Entertainment Analysis \u0026 Development\",\"wgCurRevisionId\":1076763242,\"wgRevisionId\":1076763242,\"wgArticleId\":1310632,\"wgIsArticle\":true,\"wgIsRedirect\":false,\"wgAction\":\"view\",\"wgUserName\":null,\"wgUserGroups\":[\"*\"],\"wgCategories\":[\"Articles containing Japanese-language text\",\"CS1 German-language sources (de)\",\"CS1 maint: bot: original URL status unknown\",\"Articles with short description\",\"Short description is different from Wikidata\",
\"All articles lacking reliable references\",\"Articles lacking reliable references from May 2021\",\"Articles needing additional references from May 2021\",\"All articles needing additional references\",\"Nintendo divisions and subsidiaries\",\"Video game companies established in 1983\",\"Video game companies disestablished in 2015\",\"Defunct video game companies of Japan\",\"Japanese companies disestablished in 2015\",\"Japanese companies established in 1983\"],\"wgPageContentLanguage\":\"en\",\"wgPageContentModel\":\"wikitext\",\"wgRelevantPageName\":\"Nintendo_Entertainment_Analysis_\u0026_Development\",\"wgRelevantArticleId\":1310632,\"wgIsProbablyEditable\":true,\"wgRelevantPageIsProbablyEditable\":true,\"wgRestrictionEdit\":[],\"wgRestrictionMove\":[],\"wgRedirectedFrom\":\"Nintendo_EAD\",\"wgFlaggedRevsParams\":{\"tags\":{\"status\":{\"levels\":-1}}},\"wgVisualEditor\":{\"pageLanguageCode\":\"en\",\"pageLanguageDir\":\"ltr\",\"pageVariantFallbacks\":\"en\"},\"wgMFDisplayWikibaseDescriptions\":{\"search\":true,\"nearby\":true,\"watchlist\":true,
\"tagline\":false},\"wgWMESchemaEditAttemptStepOversample\":false,\"wgWMEPageLength\":60000,\"wgNoticeProject\":\"wikipedia\",\"wgMediaViewerOnClick\":true,\"wgMediaViewerEnabledByDefault\":true,\"wgPopupsFlags\":10,\"wgULSCurrentAutonym\":\"English\",\"wgInternalRedirectTargetUrl\":\"/wiki/Nintendo_Entertainment_Analysis_%26_Development\",\"wgEditSubmitButtonLabelPublish\":true,\"wgCentralAuthMobileDomain\":false,\"wgULSPosition\":\"interlanguage\",\"wgULSisCompactLinksEnabled\":true,\"wgWikibaseItemId\":\"Q170420\",\"wgGENewcomerTasksGuidanceEnabled\":true,\"wgGEAskQuestionEnabled\":false,\"wgGELinkRecommendationsFrontendEnabled\":false};RLSTATE={\"ext.globalCssJs.user.styles\":\"ready\",\"site.styles\":\"ready\",\"user.styles\":\"ready\",\"ext.globalCssJs.user\":\"ready\",\"user\":\"ready\",\"user.options\":\"loading\",\"ext.cite.styles\":\"ready\",\"skins.vector.styles.legacy\":\"ready\",\"jquery.tablesorter.styles\":\"ready\",\"jquery.makeCollapsible.styles\":\"ready\",\"ext.visualEditor.desktopArticleTarget.noscript\":\"ready\",\"ext.wikimediaBadges\":\"ready\",
\"ext.uls.interlanguage\":\"ready\",\"wikibase.client.init\":\"ready\"};RLPAGEMODULES=[\"mediawiki.action.view.redirect\",\"ext.cite.ux-enhancements\",\"site\",\"mediawiki.page.ready\",\"jquery.tablesorter\",\"jquery.makeCollapsible\",\"mediawiki.toc\",\"skins.vector.legacy.js\",\"ext.gadget.ReferenceTooltips\",\"ext.gadget.charinsert\",\"ext.gadget.extra-toolbar-buttons\",\"ext.gadget.refToolbar\",\"ext.gadget.switcher\",\"mmv.head\",\"mmv.bootstrap.autostart\",\"ext.visualEditor.desktopArticleTarget.init\",\"ext.visualEditor.targetLoader\",\"ext.eventLogging\",\"ext.wikimediaEvents\",\"ext.navigationTiming\",\"ext.cx.eventlogging.campaigns\",\"ext.centralNotice.geoIP\",\"ext.centralNotice.startUp\",\"ext.centralauth.centralautologin\",\"ext.popups\",\"ext.uls.compactlinks\",\"ext.uls.interface\",\"ext.growthExperiments.SuggestedEditSession\"];</script>"


```{r}
data <- readRDS('data_jeux_2.rds')
data2 <- readRDS("data_jeux_image.rds")
```

```{r}
data.merge <- data %>% select("titre", "published":"misc")
data.merge <- data.merge[!duplicated(data.merge$titre),]
data.test <- data2%>% 
  left_join(data.merge, c("Name" = "titre"))
```



```{r}
" <table class=\"pct100\">
    <tbody>
      <tr valign=\"top\">
        <td width=\"1%\"><div id=\"coreGameCover\">
          <a href=\"https://www.mobygames.com/game/alone-in-the-dark/cover-art/gameCoverId,440/\">
            <img alt=\"Alone in the Dark DOS Front Cover\" border=\"0\" src=\"/images/covers/s/440-alone-in-the-dark-dos-front-cover.jpg\" height=\"152\" width=\"120\">
          </a>
        </td>
        <td width=\"48%\">
          <div id=\"coreGameRelease\">
            <div style=\"font-size: 100%; font-weight: bold;\">
              Published by
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/company/atari-europe-sasu\">
                Infogrames&nbsp;Europe&nbsp;SA
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Developed by
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/company/atari-europe-sasu\">
                Infogrames&nbsp;Europe&nbsp;SA
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Released
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/game/alone-in-the-dark/release-info\">
                1992
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Platforms
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/game/3do/alone-in-the-dark\">
                3DO
              </a>, 
              <a href=\"https://www.mobygames.com/game/acorn-32-bit/alone-in-the-dark\">
                Acorn 32-bit
              </a>
              , 
              <a href=\"https://www.mobygames.com/game/dos/alone-in-the-dark\">
                DOS
              </a>
            </div>
          </div>
        </td>
        <td width=\"48%\">
          <div id=\"coreGameGenre\">
            <div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Genre
              </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/genre/sheet/action/\">
                Action
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Perspective</div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/genre/sheet/3rd-person/\">
                3rd-person&nbsp;(Other)
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Visual
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/genre/sheet/cinematic-camera/\">
                Cinematic&nbsp;camera
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Gameplay
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/genre/sheet/puzzle-elements/\">
                Puzzle&nbsp;elements
              </a>, 
              <a href=\"https://www.mobygames.com/genre/sheet/survival-horror/\">
                Survival&nbsp;horror
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Setting
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/genre/sheet/interwar/\">
                Interwar
              </a>
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Narrative
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              <a href=\"https://www.mobygames.com/genre/sheet/horror/\">
                Horror
              </a>
            </div>
          </div>
        </div>
      </td>
    </tr>
  </tbody>  
</table>
"
```


```{r}
" <table class=\"pct100\">
    <tbody>
      <tr valign=\"top\">
        <td width=\"1%\"><div id=\"coreGameCover\">
          <img alt=\"Alone in the Dark DOS Front Cover\" border=\"0\" src=\"https://lh6.googleusercontent.com/proxy/ArqMUjwLTH8fwuNnxIWgh6VJ96iZRNrC2cCd9A-0Sz_yOqz2zo0mstHMh1etS0D8Ap6kz6XQT4C5yY1YjGaDkX5zB-G_CFhFlb4y7_ePBIlknO351AHIDLVG0VsQw_KQti3uuOkqHbE=w1200-h630-p-k-no-nu\" height=\"\" width=\"120\">
        </td>
        <td width=\"48%\">
          <div id=\"coreGameRelease\">
            <div style=\"font-size: 100%; font-weight: bold;\">
              Published by
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              Infogrames&nbsp;Europe&nbsp;SA
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Developed by
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              Infogrames&nbsp;Europe&nbsp;SA
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Released
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              1992
            </div>
            <div style=\"font-size: 100%; font-weight: bold;\">
              Platforms
            </div>
            <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
              3DO,
              Acorn 32-bit, 
              DOS
            </div>
          </div>
        </td>
        <td width=\"48%\">
          <div id=\"coreGameGenre\">
            <div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Genre
              </div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
                Action
              </div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Perspective</div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
                3rd-person&nbsp;(Other)
              </div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Visual
              </div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
                Cinematic&nbsp;camera
              </div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Gameplay
              </div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
                Puzzle&nbsp;elements,
                Survival&nbsp;horror
              </div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Setting
              </div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
                Interwar
              </div>
              <div style=\"font-size: 100%; font-weight: bold;\">
                Narrative
              </div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">
                Horror
              </div>
            </div>
          </div>
       </td>
     </tr>
   </tbody>  
</table>  
"
```

```{r}

valeur = paste0("<h1>",data.test[1,]$Name,"</h1><br></br>","<table class=\"pct100\"><tbody><tr valign=\"top\"><td width=\"1%\"><div id=\"coreGameCover\">")

if(is.na(data.test[3,]$image) == FALSE){
  valeur = paste(
    valeur, data.test[1,]$image)
}else{
  valeur = paste(valeur,
                 "<img alt=\"Alone in the Dark DOS Front Cover\" border=\"0\" src=\"https://image.freepik.com/icones-gratuites/point-d-39-interrogation_318-52837.jpg\" height=\"100\" width=\"120\">")
}

valeur = paste0(valeur, "</td><td width=\"48%\"><div id=\"coreGameRelease\">")

if(is.na(data.test[1,]$published) == FALSE){
  valeur = paste(
    valeur, "<div style=\"font-size: 100%; font-weight: bold;\">Published by</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$published,"</div>"
    )
}
if(is.na(data.test[1,]$developed) == FALSE){
  valeur = paste(valeur,
                  "<div style=\"font-size: 100%; font-weight: bold;\">Developed by</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$developed,"</div>")
}
  
if(is.na(data.test[1,]$released) == FALSE){
  valeur = paste(valeur,
                  "<div style=\"font-size: 100%; font-weight: bold;\">Released</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$released,"</div>")
  
}
  
if(is.na(data.test[1,]$platform.y) == FALSE){
  valeur = paste(valeur, 
                  "<div style=\"font-size: 100%; font-weight: bold;\">Platforms</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$platform,"</div>")
}

valeur = paste(
  valeur, 
  "</div></td><td width=\"48%\"><div id=\"coreGameGenre\"><div>")


if(is.na(data.test[1,]$genre) == FALSE){
  valeur = paste(valeur,
         "<div style=\"font-size: 100%; font-weight: bold;\">Genre</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$genre,"</div>")
}

if(is.na(data.test[1,]$gameplay) == FALSE){
  valeur = paste(valeur,
                  "<div style=\"font-size: 100%; font-weight: bold;\">Gameplay</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$gameplay,"</div>")
}

if(is.na(data.test[1,]$setting) == FALSE){
  valeur = paste(valeur,"<div style=\"font-size: 100%; font-weight: bold;\">Setting</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$setting,"</div>")
}

if(is.na(data.test[1,]$narrative) == FALSE){
  valeur = paste(valeur,"<div style=\"font-size: 100%; font-weight: bold;\">Narrative</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$narrative,"</div>")
}

if(is.na(data.test[1,]$edition) == FALSE){
  valeur = paste(valeur,"<div style=\"font-size: 100%; font-weight: bold;\">Edition</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$edition,"</div>")
}

if(is.na(data.test[1,]$visual) == FALSE){
  valeur = paste(valeur,"<div style=\"font-size: 100%; font-weight: bold;\">Visual</div>
              <div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$visual,"</div>")
}

if(is.na(data.test[1,]$misc) == FALSE){
    valeur = paste(valeur,"<div style=\"font-size: 100%; font-weight: bold;\">Misc</div><div style=\"font-size: 90%; padding-left: 1em; padding-bottom: 0.25em;\">",data.test[1,]$misc,"</div>")
}

valeur = paste(valeur,"</div></div></td></tr></tbody></table>  ")
```


