---
title: "Untitled"
author: "Chaveneau Lucas"
date: "05/03/2022"
output: html_document
---

```{r}
library(reticulate)
library(tidyverse)
library(tidyr)
library(DT)
```

```{r}
py_install('bs4')
py_install('requests')
```


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Python

```{r}
Sys.which("python")
```


```{r}
np <- import('bs4', as = 'bs')
```



########################## Table databale ############################



```{r}
data <- readRDS('data_jeux.rds')
```


```{r}
data[1:3,1:3] %>% datatable(rownames = T,
                            extensions = c('Select'),
                            selection = "first",
                            options = list(
                              select = list(style = 'os', items = 'row'), 
                              dom = 't',
                              ordering = F)) 
```


```{r}
 paste0('<img alt="Air Hockey Android Front Cover" border="0" src="https://www.mobygames.com/images/covers/s/264995-air-hockey-android-front-cover.jpg" height="120" width="120">')
```




```{r}
data[1,1:3] %>%
  mutate(image =  paste0("<img src=\"", src="https://www.mobygames.com/images/covers/s/264995-air-hockey-android-front-cover.jpg", "\" height=\"80\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"", "bijo", "\"></img>")) %>% 
  datatable(escape = F)
```
 src="/images/covers/l/264995-air-hockey-android-front-cover.png"
 
 Il risque peut etre d'avoir des problème pour la selection lorsq'uon passera sur server. Peut etre utilisé `reactable`
 
```{r}
data[1:3,1:3] %>% datatable(rownames = T,
                            extensions = c('Select'),
                            selection = "first",
                            options = list(
                              select = list(style = 'os', items = 'row'), 
                              dom = 't',
                              ordering = F)) 
```
 
```{r}
data[2,]
```
 
```{r}
data[,1:3] %>% slice(1:3) %>%
        select(everything()) %>% 
        datatable(rownames = F,
                  extensions = c('Select'),
                  selection = "single",
                  options = list(
                    select = list(style = 'os', items = 'row'), 
                    dom = 't',
                    ordering = F),
                  escape = F) 
```
 
```{r}
data$Annee <- as.factor(data$Annee)
```

```{r}
levels(data$Annee)
```

```{r}
data$platform <- as.factor(data$platform)
levels(data$platform)
```
 
 
```{r}
c(colnames(data))
```
 
```{r}
data %>%arrange(desc(reviews)) %>% slice(1:3) %>% select(Name, reviews)
```
 
```{r}
tablo <-data %>%
  filter(as.numeric(as.character(Annee)) >= 1980) %>%
  filter(as.numeric(as.character(Annee)) <= 1950)
```
 
```{r}
tablo <- data
tablo %>% 
    filter( ==1)
```

```{r}
variable_genre <- reactive({switch(
    genre1,
    "Action" = df2$Action,
    "Aventure" = df2$Aventure,
    "Puzzle" = df2$Puzzle,
    "Racing" = df2$Racing,
    "Education" = df2$Educational,
    "Compilation" = df2$Compilation,
    "Simulation" = df2$Simulation,
    "Sports" = df2$Sports,
    "Strategie" = df2$Strategie,
    "Role_play" = df2$Role_play,
    "Edition_special" = df2$Edition_special,
    "DLC" = df2$DLC)
  }) 
```

```{r}
genre1 = c('Action', 'Aventure')
```

```{r}
liste = NULL
for (element in genre1){
  liste = c(liste, element)
}
```


```{r}

switch_manuel <- function(x){switch(x, "2" = "2", "3" = "3")}
sapply(c("2","3"), switch_manuel)
```

```{r}
data %>% 
  mutate(choix = data %>% select(c(Action, Puzzle)) %>% rowSums()) %>% 
  filter(choix > 0)

data %>% 
  mutate(choix = rowSums(select(data$Troisieme_personne, data$Derriere)))

data %>% 
  filter(rowwise(c(data$Strategie, data$Sports)) > 0)

data %>% 
  filter(rowsum(Action, Puzzle) > 0)

data %>% 
  mutate(truc = rowwise(Action))
```

```{r}

```


```{r}
mutate(data, choix = select(data, ))
```

```{r}
select(data$Action)
```

```{r}
paste0('df')
```
```{r}
data %>% 
  rowwise() %>% 
  mutate(truc = sum(c(data$Action, data$Puzzle)))
```

```{r}
mutate(data, )
```

```{r}
data <- as_tibble(data)
```

```{r}
class(data)
```
```{r}
data[c('Action', 'Puzzle')]
```
```{r}
data[,c(data$Action, data$Puzzle)]
```

```{r}
tablo <- data[1:100000,]
```


```{r}
tablo %>% 
  filter(tablo[c('Action', 'Puzzle')] %>% rowSums() > 0)
```

```{r}
data %>% slice(numeric(1))
numeric(1)
```

```{r}
cat(data$Description[1])
```
```{r}
description <- data %>% slice(3) %>% pull(Description)
```

```{r}
paste0('<b>', description %>% str_replace("\n", "<br>"), '</b>')
description %>% str_replace("\n", "<br>")
```

```{r}
desc2 <- "Ndsqjdqso. jDIOQSJOSDQ.oids. "
str_to_title(desc2)
```

```{r}
str_to_sentence(desc2)
```

```{r}
desc <- "\nTwo titles are available in this cart:\narmored encounter! is a clone of atari's combat. two players control tanks and try to shoot each other the most in a time limit of three minutes. each tank has 20 rounds of ammunition. the last three rounds will change color, warning the player the ammunition is low. this game offers 12 variations, selected by the alphanumeric keys:\n(pressing a): plays over open country using cannon.\n(pressing b): plays over hilly terrain (simple bars) with cannon.\n(pressing c): plays over mountainous terrain (complex barriers) with cannon.\n(pressing d): open country with guided missiles.\n(pressing e): simple barriers with guided missiles.\n(pressing f): complex barriers with guided missiles.\n(pressing g): plays over open country with minefields (represented by x's on the screen - if a tank hits one of them, a point is scored to the adversary) and cannon.\n(pressing h): simple barriers with minefields and cannon.\n(pressing i): complex barriers with minefields and cannon.\n(pressing j): open country - minefields - guided missiles.\n(pressing k): simple barriers - minefields - guided missiles.\n(pressing l): complex barriers - minefields - guided missiles.\n\n\nsub chase! features a hawk hunter-killer jet against a shark missile-launching submarine. one player controls the jet, which scrolls left, and the other controls the submarine, which scrolls right. while neutral ships sail on the water surface, the players have to shoot each other the most in a time limit of three minutes. each hit on the enemy scores one point to the player and each hit on the neutral vessels subtracts one point. there are three game variations, selected by the numeric keys:(pressing 1): guided missiles with rear launch pattern.\n(pressing 2): unguided missiles with rear launch pattern.\n(pressing 3): guided missiles with forward launch pattern.\n[edit description]"

```


```{r}
desc %>% str_to_upper() %>% str_to_sentence()
```

## Creation des noms de publisher 

```{r}
data$Publisher <- as.factor(data$Publisher)
```

```{r}
truc = fct_count(data$Publisher, sort = T)[1:3500,1]
```

```{r}
truc
```

```{r}
data <- readRDS('data_jeux_image.rds')
```


```{r}
df <- read_csv('vgsales2.csv')
```

```{r}
data <- readRDS('data_jeux_image.rds')
```


```{r}
data[1,30] %>% 
  str_replace('src=\"/', "src=\"https://www.mobygames.com/")
```
```{r}
paste0("<img alt=\"007: James Bond - The Stealth Affair DOS Front Cover\" border=\"0\" height=\"150\" src=\"https://www.mobygames.com/images/covers/s/261101-007-james-bond-the-stealth-affair-dos-front-cover.jpg\" width=\"120\"/>")
```


```{r}
iscreen <- "<img alt=\"007 Car Chase Commodore 64 Title\" border=\"0\" height=\"112\" src=\"https://www.mobygames.com/images/shots/s/311197-007-car-chase-commodore-64-screenshot-title.jpg\" title=\"Missing cover image (using game screenshot)\" width=\"160\">"
```

```{r}
paste0("<img src=\"", src="https://www.mobygames.com/images/covers/s/264995-air-hockey-android-front-cover.jpg", "\" height=\"80\" data-toggle=\"tooltip\" data-placement=\"right\" title=\"", "bijo", "\"></img>")
```


```{r}
iscreen <- "<img alt=\"007: James Bond - The Stealth Affair DOS Front Cover\" border=\"0\" height=\"150\" src=\"https://www.mobygames.com/images/covers/s/261101-007-james-bond-the-stealth-affair-dos-front-cover.jpg\" width=\"120\"/>"
```


```{r}


data %>% 
  slice(1:3) %>% 
  mutate(picture = c(iscreen, iscreen, iscreen)) %>% 
  select(picture, Name) %>% 
  datatable()
```

```{r}
"<img title="Missing cover image (using game screenshot)" alt="007 Car Chase Commodore 64 Title" border="0" src="/images/shots/s/311197-007-car-chase-commodore-64-screenshot-title.jpg" height="112" width="160">"
```



```{r}
data[1,1:3] %>%
  mutate(image =  paste0("<img alt=\"007 Ice Racer ExEn Game splashscreen\" border=\"0\" height=\"80\" src=\"https://www.mobygames.com/images/shots/s/149436-007-ice-racer-exen-screenshot-game-splashscreen.jpg\" title=\"Missing cover image (using game screenshot)\" width=\"104\"/>")) %>% 
  datatable(escape = F)
```



